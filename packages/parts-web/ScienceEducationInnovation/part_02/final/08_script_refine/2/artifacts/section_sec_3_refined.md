## 关键问题与核心思路

### 1. 核心思路：算法、系统、硬件协同设计

为解决推荐系统的性能瓶颈，我们提出了一套贯穿算法、系统、硬件三个层面的协同设计思路。其核心在于使各层面相互感知，以实现全局最优。

*   **算法层面：设计硬件感知的算法**
    *   **目标**：提升硬件资源利用率，例如通过设计缓存感知算法来提高缓存命中率。
    *   **实践**：面向异构内存的参数放置算法。
*   **系统层面：设计算法感知的系统**
    *   **目标**：根据算法特性优化系统性能，例如设计能感知参数重要性的存储系统。
    *   **实践**：面向异构内存的参数存储系统。
*   **硬件层面：设计系统感知的硬件**
    *   **目标**：根据系统数据流特性提升硬件效率，例如设计能感知数据流的专用硬件。
    *   **实践**：面向异构内存的参数访问硬件。

### 2. 算法层实践：面向异构内存的参数放置算法 (OptEmbed)

我们在算法层面的具体实践是发表于 OSDI 2022 的工作 `OptEmbed`。

#### 2.1 背景：传统缓存替换算法的局限性

推荐模型参数具有显著的访问倾斜性，适合使用缓存机制进行优化。然而，当缓存写满时，必须决定淘汰哪些参数。传统的缓存替换算法（如 `LRU`）存在以下局限：

*   **单一决策维度**：`LRU` (Least Recently Used) 算法仅依据参数的访问频率（或近期性）进行淘汰决策。
*   **忽略参数重要性**：该机制未考虑参数对模型精度的影响。一个访问频率高但对模型精度影响甚微的参数，可能并不值得占用宝贵的缓存空间。

#### 2.2 解决方案：基于综合评分的缓存替换算法 `OptEmbed`

针对上述问题，我们设计了一种新的缓存替换算法 `OptEmbed`，该算法同时评估参数的访问频率与重要性。

*   **核心机制**：为每个参数计算一个综合分数。
    *   `Score = f(访问频率, 参数重要性)`
    *   该分数是访问频率和重要性的加权和。
*   **淘汰策略**：当缓存需要替换时，优先淘汰综合分数最低的参数。
*   **预期效果**：通过此策略，可以确保缓存中保留的都是访问频繁且对模型精度影响较大的关键参数。实验结果验证，`OptEmbed` 能够在保证模型精度的前提下，有效提升缓存命中率。