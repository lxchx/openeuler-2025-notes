## 关键技术二：基于大语言模型的攻击检测与日志理解

### 1. 问题背景：底层日志与自然语言报告的鸿沟

在网络安全领域，攻击检测系统通常会生成基于底层事件（如文件访问、端口访问）的图谱。然而，这种图谱对于非专业人员而言难以理解，与人类可读的自然语言攻击报告之间存在巨大的语义鸿沟。

传统的解决方法依赖于硬性匹配（Hard Matching），例如在文本中查找特定的文件名。这种方法缺乏泛化能力，无法有效应对多变的攻击手法。

### 2. 解决方案：gIoC 中间表述与大语言模型

为了弥合这一鸿沟，我们提出了一种名为 `gIoC` (Generalized Indicator of Compromise) 的中间表述方法。该方法旨在让大语言模型（LLM）具备理解底层日志事件并进行泛化的能力。

- **设计思路**：
  - `gIoC` 在形式上贴近底层事件的结构。
  - 对其中的参数进行泛化处理，而非使用具体实例。
- **实现效果**：
  - 通过 `gIoC`，即使在训练数据有限的情况下，也能利用大模型的理解能力，将底层事件与上层威胁情报中的知识进行有效匹配。
  - 使大模型能够理解底层日志，并输出具有泛化能力的文本描述。

### 3. 优化：结合攻击逻辑推理消除误报

仅依赖大模型进行自动标注可能会产生大量误报。为此，我们引入了一套基于攻击步骤逻辑关系的推理系统进行优化。

- **核心逻辑**：攻击行为遵循特定的先后顺序。例如，攻击者必须先获得登录权限，然后才能安装恶意软件。不符合此逻辑的事件链将被视为异常。
- **实施流程**：
  1.  利用该推理系统，对大模型初步标注的结果进行校验。
  2.  消除大量不符合攻击逻辑的误报节点。
  3.  最终生成的攻击图谱中，每个节点都清晰地标注了其对应的攻击技术、手法和归属。

### 4. 自动化：安全 Agent 生成攻击报告

我们将经过推理和精炼后的攻击图谱输入到一个安全 Agent 中，由其自动生成最终的自然语言攻击报告。

整个处理流程并非端到端的单一模型，而是一个多阶段的系统：

1.  **过滤与处理**：首先通过小模型算法对海量（千万级别）原始事件进行初步筛选和处理。
2.  **精选事件**：从海量数据中挑选出几十个与攻击高度相关的核心事件。
3.  **LLM 处理**：将精选事件交由大语言模型处理，生成结构化的攻击描述。
4.  **报告生成**：最后由安全 Agent 整合信息，自动生成报告。

### 5. 成果与结论

该方法在华为内部的 openEuler 运维数据上进行了测试，取得了显著成果：

- **自动化报告**：成功实现了从底层日志到自然语言攻击报告的全流程自动化生成。
- **降低误报率**：与现有方法相比，整体误报率降低了一个数量级。