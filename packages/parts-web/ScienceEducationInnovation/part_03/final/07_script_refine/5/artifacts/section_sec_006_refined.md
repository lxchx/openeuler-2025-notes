# 关键技术：基于大语言模型与 gIoC 的攻击理解与自动化报告生成

## 1. 背景与挑战
在网络安全分析中，尽管底层检测系统能够捕获攻击行为并生成图结构数据，但这些数据对人类分析师而言并不直观。将底层技术细节转化为高层语义报告面临以下挑战：

*   **语义鸿沟 (Semantic Gap)**：底层系统日志与高层攻击意图之间存在巨大的理解断层。
*   **泛化能力不足**：传统方法多采用“硬匹配”（如特定文件名匹配），难以应对变体攻击或未知威胁。
*   **数据与成本限制**：直接训练端到端的大模型（LLM）理解底层日志需要海量标注数据，且计算成本极高。

## 2. 核心架构设计：gIoC 中间表示
为了弥合语义鸿沟并提升泛化能力，本方案引入了 **gIoC (Graph-based Indicators of Compromise)** 作为中间表示层。

### 2.1 设计理念
*   **形态对齐**：gIoC 在形式上保持与底层事件的高度接近，降低转换难度。
*   **参数泛化**：对底层事件中的具体参数进行泛化处理，使其不再局限于特定的文件路径或进程名，从而具备跨场景的泛化能力。
*   **知识匹配**：利用轻量化模型将语言理解能力与威胁情报知识库进行关联，实现底层日志与攻击手法的精准映射。

## 3. 关键技术实现路径

### 3.1 分层处理流程（非纯端到端架构）
为了兼顾效率与准确性，系统采用了“先过滤、后生成”的非对称架构：
1.  **海量筛选**：通过小模型算法从数千万个原始事件中剔除噪音。
2.  **精选输入**：提取出几十个关键攻击事件转化为 gIoC 表示。
3.  **深度理解**：将精选事件提交给大模型进行最终的逻辑整合与报告生成。

### 3.2 逻辑推理框架
为了进一步降低误报，系统构建了基于攻击技术逻辑关系的推理引擎：
*   **因果校验**：利用攻击阶段的先后顺序（例如：必须先“获取权限”才能执行“安装病毒”）进行逻辑验证。
*   **节点标注**：在图结构节点上自动标注对应的攻击技术（ATT&CK TTPs）和手法。
*   **误报消除**：通过逻辑不一致性识别并剔除不符合攻击链路规律的孤立事件。

### 3.3 安全 Agent 自动化报告
最终阶段由安全 Agent 调用大模型能力，将经过逻辑校验的攻击链路转化为人类可读的自然语言报告，详细阐述攻击者的路径、手段及影响范围。

## 4. 落地验证与成效
该技术已在 **openEuler** 运维数据场景中得到验证：
*   **自动化程度**：实现了从底层日志到自然语言报告的全自动生成。
*   **检测精度**：相比现有基于硬匹配或传统图分析的方法，**误报率降低了一个数量级**。